(()=>{"use strict";var e,t;!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var n,o,a,c,r,l,s=function(){document.querySelector("#cb-highshelf").checked?(n.frequency.setValueAtTime(1e3,t.currentTime),n.gain.setValueAtTime(25,t.currentTime)):n.gain.setValueAtTime(0,t.currentTime)},i=function(){document.querySelector("#cb-lowshelf").checked?(o.frequency.setValueAtTime(1e3,t.currentTime),o.gain.setValueAtTime(15,t.currentTime)):o.gain.setValueAtTime(0,t.currentTime)},u=function(e){a.src=e},h=function(e,t,n,o){return void 0===o&&(o=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},d=function(e,t){return Math.random()*(t-e)+e},f=function(){function e(e,t,n){this.x=e,this.y=t,this.range=n,this.radius=d(2,6),this.startAngle=0,this.endAngle=2*Math.PI}return e.prototype.update=function(){this.xDraw=d(this.x-this.range/2,this.x+this.range/2),this.yDraw=d(this.y-this.range/2,this.y+this.range/2),this.radius=d(2,6)},e.prototype.draw=function(e){k(e,this.xDraw,this.yDraw,this.radius,this.color,this.startAngle,String(this.endAngle))},e.type="arc",e}();const g=f;document.querySelector("controls");var v,m,w,y,S,b,p,k=function(e,t,n,o,a,c,r,l,s){void 0===l&&(l=0),void 0===s&&(s=2*Math.PI),e.save(),e.beginPath(),e.arc(t,n,o,l,s),e.fill(),c>0&&(e.lineWidth=c,e.strokeStyle=r,e.stroke()),e.closePath(),e.restore()},q=new g(50,50,50),T=new g(750,50,50);p={showBars:!1,showCircles:!1,showNoise:!1,showInvert:!1,showEmboss:!1};var I=!0,A=Object.freeze({sound1:"media/New Adventure Theme.mp3"}),P=function(e){var t=e.target.responseText,n=JSON.parse(t);p.showBars=n.uiInitialState.showBars,p.showCircles=n.uiInitialState.showCircles,p.showNoise=n.uiInitialState.showNoise,p.showInvert=n.uiInitialState.showInvert,p.showEmboss=n.uiInitialState.showEmboss},M=function(e){var n=document.querySelector("#fs-button"),o=document.querySelector("#cb-highshelf");o.checked=!1;var c=document.querySelector("#cb-lowshelf");c.checked=!1,n.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()};var r=document.querySelector("#play-button");r.onclick=function(e){console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state)),"no"==r.dataset.playing?(a.play(),r.dataset.playing="yes"):(a.pause(),r.dataset.playing="no");var n=document.querySelector("#bars-cb");n.onclick=function(e){p.showBars=n.checked};var l=document.querySelector("#circles-cb");n.onclick=function(e){p.showCircles=l.checked};var u=document.querySelector("#noise-cb");u.onclick=function(e){p.showNoise=u.checked};var h=document.querySelector("#invert-cb");h.onclick=function(e){p.showInvert=h.checked};var d=document.querySelector("#emboss-cb");d.onclick=function(e){p.showEmboss=d.checked},o.onclick=function(e){s()},c.onclick=function(e){i()},s(),i()};var h=document.querySelector("#volume-slider"),d=document.querySelector("#volume-label");h.oninput=function(e){var t,n=e.target;t=n.value,t=Number(t),l.gain.value=t,d.innerHTML=String(Math.round(Number(n.value)/2*100))},h.dispatchEvent(new Event("input"));var f=document.querySelector("#track-select");f.onchange=function(e){u(f.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))},document.querySelector("#visual-select").onchange=function(e){I=!I,console.log(I)},R()},R=function(){setTimeout(R,1e3/60),function(e){if(y.getByteFrequencyData(S),v.save(),v.fillStyle="black",v.globalAlpha=.1,v.fillRect(0,0,m,w),v.restore(),I){if(e.showBars){var t=(m-4*S.length-10)/S.length;v.save(),v.strokeStyle="rgba(0, 0, 0, 0, .5)";for(var n=0;n<S.length;n++)v.fillStyle=h(156-S[n],256-Math.round(S[n]/2),256-S[n],.5),v.fillRect(5+n*(t+4),356-S[n],t,200),v.strokeRect(5+n*(t+4),356-S[n],t,200);v.restore()}if(e.showCircles){var o=w/4;for(v.save(),v.globalAlpha=.5,n=0;n<S.length;n++){var a=S[n]/255;v.strokeStyle="teal";var c=a*o;v.beginPath(),v.strokeStyle=h(124,223,4*c,.34-a/3),v.arc(m/2,w/2,c,0,2*Math.PI,!1),v.stroke(),v.closePath(),v.beginPath(),v.fillStyle=h(87,41,5*c,.1-a/10),v.arc(m/2,w/2,1.5*c,0,2*Math.PI,!1),v.stroke(),v.closePath(),v.beginPath(),v.fillStyle=h(13,156,.5*c,.5-a/5),v.arc(m/2,w/2,.5*c,0,2*Math.PI,!1),v.stroke(),v.closePath()}v.restore()}var r=v.getImageData(0,0,m,w),l=r.data,s=l.length,i=r.width;for(n=0;n<s;n+=4)if(e.showNoise&&Math.random()<.05&&(l[n]=l[n+1]=l[n+2]=0,l[n+2]=255),e.showInvert){var u=l[n],d=l[n+1],f=l[n+2];l[n]=255-u,l[n]=255-d,l[n]=255-f}if(e.showEmboss)for(n=0;n<s;n++)n%4!=3&&(l[n]=127+2*l[n]-l[n+4]-l[n+4*i]);v.putImageData(r,0,0);for(var g=0,p=S;g<p.length;g++){var k=p[g];v.save(),v.fillStyle="rgb(".concat(k/12,", ").concat(82-k,", ").concat(k,")"),q.update(),q.draw(v),T.update(),T.draw(v),v.restore()}}else{v.fillStyle="rgba(0,0,0,.1)",v.fillRect(0,0,m,w),v.fillStyle="red",v.save(),v.translate(360,b-100);for(var A=0,P=S;A<P.length;A++)(a=(k=P[A])/225)<.02&&(a=.02),v.translate(18,0),v.rotate(2*Math.PI/32),v.save(),v.scale(1,-1),v.fillStyle="rgb(".concat(k,", ").concat(k-128,", ").concat(255-k,")"),v.fillRect(0,0,18,60*a),v.restore(),v.translate(4,0);v.restore(),v.save(),v.strokeStyle="white",v.lineWidth=3;var M=-m/S.length,R=b+180;v.beginPath(),v.moveTo(M,R);for(var F=0,E=S;F<E.length;F++)k=E[F],v.lineTo(M,R-k),M+=m/(S.length-10);v.stroke(),v.closePath(),v.restore();for(var x=0,C=S;x<C.length;x++)k=C[x],v.save(),v.fillStyle="rgb(".concat(k,", ").concat(k-128,", ").concat(255-k,")"),q.update(),q.draw(v),T.update(),T.draw(v),v.restore()}}(p)};window.onload=function(){console.log("window.onload called"),function(){var s,i,h;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((s=function(){return d(35,220)})(),",").concat(s(),",").concat(s(),",1)"))),i=A.sound1,h=window.AudioContext,t=new h,a=new Audio,u(i),c=t.createMediaElementSource(a),(n=t.createBiquadFilter()).type="highshelf",(o=t.createBiquadFilter()).type="lowshelf",(r=t.createAnalyser()).fftSize=e.numSamples,(l=t.createGain()).gain.value=e.gain,c.connect(n),n.connect(o),o.connect(r),r.connect(l),l.connect(t.destination);var f,g,p=document.querySelector("canvas");!function(e,t){v=e.getContext("2d"),m=e.width,w=e.height,b=w/2,y=t,S=new Uint8Array(y.fftSize/2)}(p,r),f=P,(g=new XMLHttpRequest).onload=f,g.open("GET","data/ac-data.json"),g.send(),M(p)}()}})();
//# sourceMappingURL=bundle.js.map